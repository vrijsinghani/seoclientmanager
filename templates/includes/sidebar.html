{% load static %}

<aside class="sidenav navbar navbar-vertical navbar-expand-xs border-0 border-radius-xl my-3 fixed-start ms-3 " id="sidenav-main">
  <div class="sidenav-header">
    <i class="fas fa-times p-3 cursor-pointer text-secondary opacity-5 position-absolute end-0 top-0 d-none d-xl-none" aria-hidden="true" id="iconSidenav"></i>
    <a class="navbar-brand m-0" href="/">
      <img src="{% static 'assets/neuralami/logos/NeuralamiLogo51x51.png' %}" class="navbar-brand-img h-100" alt="main_logo">
      <span class="ms-1 font-weight-bold">Neuralami Control Center</span>
    </a>
  </div>
  <hr class="horizontal dark mt-0">
  <div class="collapse navbar-collapse w-auto" id="sidenav-collapse-main">
    <ul class="navbar-nav">
      <li class="nav-item">
        <a data-bs-toggle="collapse" href="#dashboardSubmenu" class="nav-link {% if request.resolver_match.url_name == 'dashboard' or request.resolver_match.url_name == 'llm-dashboard' %}active{% endif %}" aria-controls="dashboardSubmenu" role="button" aria-expanded="{% if request.resolver_match.url_name == 'dashboard' or request.resolver_match.url_name == 'llm-dashboard' %}true{% else %}false{% endif %}">
          <div class="icon icon-shape icon-sm shadow border-radius-md bg-white text-center me-2 d-flex align-items-center justify-content-center">
            <i class="ni ni-tv-2 text-primary text-sm opacity-10"></i>
          </div>
          <span class="nav-link-text ms-1">Dashboard</span>
        </a>
        <div class="collapse {% if request.resolver_match.url_name == 'dashboard' or request.resolver_match.url_name == 'llm-dashboard' %}show{% endif %}" id="dashboardSubmenu">
          <ul class="nav ms-4 ps-3">
            <li class="nav-item">
              <a class="nav-link {% if request.resolver_match.url_name == 'dashboard' %}active{% endif %}" href="{% url 'seo_manager:dashboard' %}">
                <span class="sidenav-mini-icon"> O </span>
                <span class="sidenav-normal"> Overview </span>
              </a>
            </li>
            {% if request.user.is_staff %}
            <li class="nav-item">
              <a class="nav-link {% if request.resolver_match.url_name == 'llm-dashboard' %}active{% endif %}" href="{% url 'llm-dashboard' %}">
                <span class="sidenav-mini-icon"> <i class="ni ni-chart-bar-32 text-info"></i> </span>
                <span class="sidenav-normal"> LLM Analytics </span>
              </a>
            </li>
            {% endif %}
          </ul>
        </div>
      </li>
      <li class="nav-item">
        <a class="nav-link {% if request.resolver_match.url_name == 'client_list' %}active{% endif %}" href="{% url 'seo_manager:client_list' %}">
          <div class="icon icon-shape icon-sm shadow border-radius-md bg-white text-center me-2 d-flex align-items-center justify-content-center">
            <i class="ni ni-briefcase-24 text-primary text-sm opacity-10"></i>
          </div>
          <span class="nav-link-text ms-1">Clients</span>
        </a>
      </li>
      <!-- Agent Crews section with submenu -->
      <li class="nav-item">
        <a data-bs-toggle="collapse" href="#agentCrewsSubmenu" class="nav-link {% if 'agents' in request.resolver_match.app_name %}active{% endif %}" aria-controls="agentCrewsSubmenu" role="button" aria-expanded="{% if 'agents' in request.resolver_match.app_name %}true{% else %}false{% endif %}">
          <div class="icon icon-shape icon-sm shadow border-radius-md bg-white text-center me-2 d-flex align-items-center justify-content-center">
            <i class="ni ni-spaceship text-primary text-sm opacity-10"></i>
          </div>
          <span class="nav-link-text ms-1">Agent Crews</span>
        </a>
        <div class="collapse {% if 'agents' in request.resolver_match.app_name %}show{% endif %}" id="agentCrewsSubmenu">
          <ul class="nav ms-4 ps-3">
            <li class="nav-item">
              <a class="nav-link {% if request.resolver_match.url_name == 'crewai_home' %}active{% endif %}" href="{% url 'agents:crewai_home' %}">
                <span class="sidenav-mini-icon"> O </span>
                <span class="sidenav-normal"> Overview </span>
              </a>
            </li>
            <li class="nav-item">
              <a class="nav-link {% if request.resolver_match.url_name == 'manage_agents' %}active{% endif %}" href="{% url 'agents:manage_agents_card_view' %}">
                <span class="sidenav-mini-icon"> <i class="ni ni-single-02 text-info"></i> </span>
                <span class="sidenav-normal"> Manage Agents </span>
              </a>
            </li>
            <li class="nav-item">
              <a class="nav-link {% if request.resolver_match.url_name == 'manage_tasks' %}active{% endif %}" href="{% url 'agents:manage_tasks' %}">
                <span class="sidenav-mini-icon"> <i class="ni ni-bullet-list-67 text-primary"></i> </span>
                <span class="sidenav-normal"> Manage Tasks </span>
              </a>
            </li>
            <li class="nav-item">
              <a class="nav-link {% if request.resolver_match.url_name == 'manage_tools' %}active{% endif %}" href="{% url 'agents:manage_tools' %}">
                <span class="sidenav-mini-icon"> <i class="ni ni-settings text-warning"></i> </span>
                <span class="sidenav-normal"> Manage Tools </span>
              </a>
            </li>
            <li class="nav-item">
              <a class="nav-link {% if request.resolver_match.url_name == 'manage_crews' %}active{% endif %}" href="{% url 'agents:manage_crews_card_view' %}">
                <span class="sidenav-mini-icon"> <i class="ni ni-circle-08 text-success"></i> </span>
                <span class="sidenav-normal"> Manage Crews </span>
              </a>
            </li>
            <li class="nav-item">
              <a class="nav-link {% if request.resolver_match.url_name == 'manage_pipelines' %}active{% endif %}" href="{% url 'agents:manage_pipelines' %}">
                <span class="sidenav-mini-icon"> <i class="ni ni-atom text-danger"></i> </span>
                <span class="sidenav-normal"> Manage Pipelines </span>
              </a>
            </li>
            <li class="nav-item">
              <a class="nav-link {% if request.resolver_match.url_name == 'chat' %}active{% endif %}" href="{% url 'agents:chat' %}">
                <span class="sidenav-mini-icon"> <i class="ni ni-chat-round text-info"></i> </span>
                <span class="sidenav-normal"> Agent Chat </span>
              </a>
            </li>
          </ul>
        </div>
      </li>
      <li class="nav-item">
        <a class="nav-link {% if request.resolver_match.url_name == 'activity_log' %}active{% endif %}" href="{% url 'seo_manager:activity_log' %}">
          <div class="icon icon-shape icon-sm shadow border-radius-md bg-white text-center me-2 d-flex align-items-center justify-content-center">
            <i class="ni ni-calendar-grid-58 text-primary text-sm opacity-10"></i>
          </div>
          <span class="nav-link-text ms-1">Activity Log</span>
        </a>
      </li>
      <li class="nav-item">
        <a class="nav-link {% if request.resolver_match.url_name == 'crawl_website' %}active{% endif %}" href="{% url 'crawl_website:index' %}">
          <div class="icon icon-shape icon-sm shadow border-radius-md bg-white text-center me-2 d-flex align-items-center justify-content-center">
            <i class="ni ni-world-2 text-primary text-sm opacity-10"></i>
          </div>
          <span class="nav-link-text ms-1">Crawl Website</span>
        </a>
      </li>
      <li class="nav-item">
        <a class="nav-link {% if request.resolver_match.url_name == 'summarize' %}active{% endif %}" href="{% url 'seo_manager:summarize_view' %}">
          <div class="icon icon-shape icon-sm shadow border-radius-md bg-white text-center me-2 d-flex align-items-center justify-content-center">
            <i class="ni ni-scissors text-primary text-sm opacity-10"></i>
          </div>
          <span class="nav-link-text ms-1">Summarize</span>
        </a>
      </li>
      <li class="nav-item">
        <a class="nav-link {% if request.resolver_match.url_name == 'file_manager' %}active{% endif %}" href="{% url 'file_manager' %}">
          <div class="icon icon-shape icon-sm shadow border-radius-md bg-white text-center me-2 d-flex align-items-center justify-content-center">
            <i class="ni ni-folder-17 text-primary text-sm opacity-10"></i>
          </div>
          <span class="nav-link-text ms-1">File Manager</span>
        </a>
      </li>
      
      {% if client %}
      <li class="nav-item mt-3">
        <h6 class="ps-4 ms-2 text-uppercase text-xs font-weight-bolder opacity-6">Client: {{ client.name }}</h6>
      </li>
      <li class="nav-item">
        <a class="nav-link {% if request.resolver_match.url_name == 'client_detail' %}active{% endif %}" href="{% url 'seo_manager:client_detail' client.id %}">
          <div class="icon icon-shape icon-sm shadow border-radius-md bg-white text-center me-2 d-flex align-items-center justify-content-center">
            <i class="ni ni-single-02 text-dark text-sm opacity-10"></i>
          </div>
          <span class="nav-link-text ms-1">Overview</span>
        </a>
      </li>
      <li class="nav-item">
        <a class="nav-link {% if request.resolver_match.url_name == 'client_analytics' %}active{% endif %}" href="{% url 'seo_manager:client_analytics' client.id %}">
          <div class="icon icon-shape icon-sm shadow border-radius-md bg-white text-center me-2 d-flex align-items-center justify-content-center">
            <i class="ni ni-chart-bar-32 text-info text-sm opacity-10"></i>
          </div>
          <span class="nav-link-text ms-1">Analytics</span>
        </a>
      </li>
      {% endif %} 
    </ul>
  </div>
  <div class="collapse navbar-collapse  w-auto h-auto" id="sidenav-collapse-main">
    {% include 'includes/menu-list.html' %}
  </div>
</aside>